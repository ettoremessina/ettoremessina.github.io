

<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head lang="en">
		<meta http-equiv="content-language" content="en">
		<meta name="author" content="Ettore Messina">	

		<style>
			#cookiescript_checkbox_input {
				-moz-appearance: checkbox;
				-webkit-appearance: checkbox;
				-ms-appearance: checkbox;
				appearance: checkbox;
				opacity: 1.0;
			}
			#cookiescript_checkbox_text {
				color: white;
			}
			#cookiescript_description a:hover {
				color: yellow !important;
			}
		</style>
		<script type="text/javascript" charset="UTF-8" src="https://cookie-script.com/s/19e1626ea9f21a6fcc285b559b5957e6.js"></script>
		<script type="text/plain" data-cookiescript="accepted" data-cookiecategory="performance" src="https://www.googletagmanager.com/gtag/js?id=UA-149444322-1"></script>
		<script type="text/plain" data-cookiescript="accepted" data-cookiecategory="performance">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-149444322-1', { 'anonymize_ip': true });
		</script>


		<title>SMO regression for SVM with PUK kernel in Weka</title>
		<meta name="description" content="Fitting of a one variable real function using the SMO regression for SVM with PUK kernel in Weka" >
		<meta name="keywords" content="regression, SMO, SVM, PUK, kernel, approximation, fitting, function, dataset, mean squared error, machine learning, Weka" >
		<link rel="canonical" href="https://computationalmindset.com/en/machine-learning/smo-regression-with-puk-kernel-in-weka.html" />
		<link rel="alternate" hreflang="en" href="https://computationalmindset.com/en/machine-learning/smo-regression-with-puk-kernel-in-weka.html" />
		<link rel="alternate" hreflang="it" href="https://computationalmindset.com/it/machine-learning/regressione-smo-con-kernel-puk-in-weka.html" />
		
    <!-- SCHEMA.ORG JSON-LD WEBSITE -->
    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "WebSite",
        "name": "Computational Mindset",
        "url": "https://computationalmindset.com/",
        "sameAs": ["https://www.facebook.com/ComputationalMindset/", "https://github.com/ettoremessina/"],
        "author":
        {
          "@type": "Person",
          "name": "Ettore Messina",
          "image": "https://computationalmindset.com/images/ettore-messina.jpg",
          "gender": "Male",          
          "sameAs": ["https://www.facebook.com/ettore.messina.73/", "https://www.instagram.com/etmessina/", "https://twitter.com/ettoremessina/", "https://twitter.com/Computational_M/", "https://github.com/ettoremessina/", "https://medium.com/@ettoremessina/", "https://www.linkedin.com/in/ettoremessina", "https://www.linkedin.com/company/computational-mindset"]
        }
    }
    </script>

		
    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement":
        [
		
          {
            "@type": "ListItem",
            "position": 1,
            "item":
            {
                "@id": "https://computationalmindset.com/en/",
                "name": "Computational Mindset"
            }
          },
		
          {
            "@type": "ListItem",
            "position": 2,
            "item":
            {
              "@id": "https://computationalmindset.com/en/machine-learning/",
              "name": "Machine Learning"
            }
          },

          {
            "@type": "ListItem",
            "position": 3,
            "item":
            {
              "@id": "https://computationalmindset.com/en/machine-learning/smo-regression-with-puk-kernel-in-weka.html",
              "name": "SMO regression for SVM with PUK kernel in Weka"
            }
		  }
		
        ]
    }
    </script>
		

		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/railscasts.min.css">
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
		
		<script>hljs.initHighlightingOnLoad();</script>
		<style>
			pre > code 
			{
				font-size: 1.2em;
			}
		</style>

		
		<script type="text/javascript" src="https://latex.codecogs.com/latexit.js"></script>
		<script type="text/x-mathjax-config">
			MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
		</script>
		<script type="text/javascript"
			src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>



		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../../assets/css/main.css" />
		<link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon" />
		<link rel="icon" href="../../favicon.ico" type="image/x-icon" />
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a href="../../en/info.html" class="logo"><strong>Computational&nbsp;Mindset</strong> by&nbsp;Ettore&nbsp;Messina</a>
									<div style="text-align:right">
										<a class="logo" href="../../en/">en</a>
										&nbsp;&nbsp;&nbsp;
										<a class="logo" href="../../it/">it</a>
									</div>
									<ul class="icons">
										<li><a href="https://github.com/ettoremessina/" class="icon brands fa-github" target="_blank"><span class="label">GitHub</span></a></li>
										<li><a href="https://www.linkedin.com/company/computational-mindset" class="icon brands fa-linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
										<li><a href="https://twitter.com/Computational_M/" class="icon brands fa-twitter" target="_blank"><span class="label">Twitter</span></a></li>
										<li><a href="https://www.facebook.com/ComputationalMindset/" class="icon brands fa-facebook-f" target="_blank"><span class="label">Facebook</span></a></li>
										<li><a href="https://www.youtube.com/c/ComputationalMindset/" class="icon brands fa-youtube" target="_blank"><span class="label">YouTube</span></a></li>
										<li><a href="https://medium.com/@ettoremessina/" class="icon brands fa-medium-m" target="_blank"><span class="label">Medium</span></a></li>
										<li><a href="https://linktr.ee/ComputationalMindset/" class="fas fa-link" style="color: grey;" target="_blank"><span class="label"></span></a></li>
									</ul>
								</header>

<!-- Content -->
	<section>
		<header class="main">
			<h1>SMO regression for SVM with PUK kernel in Weka</h1>
		</header>

		<p>
			This post shows a use in Weka of the <em>SMOreg</em> regressor (Sequential Minimal Optimization) which is an efficient machine learning algorithm for SVM (Support Vector Machine)
			to implement the approximation of one-variable continuous and limited real functions defined in a range of reals via <em>PUK</em> kernel (Pearson VII function-based Universal Kernel);
			the objective is to demonstrate that classic machine learning regression can achieve interesting levels of accuracy with extremely short learning times.<br />
			Although MLP (Multi Layer Perceptron) type neural networks can be considered universal function approximators (see <a href="../../en/neural-networks/fitting-with-multi-layer-perceptrons-highly-configurable.html">Fitting with highly configurable multi layer perceptrons</a> on this website),
			a classic supervised machine learning regression algorithm, like the one presented here, can reach acceptable levels of accuracy and with a significantly lower computational cost than that of an MLP.<br />
			<br />
			In the real world datasets pre-exist the learning phase, in fact they are obtained by extracting data from production databases or Excel files,
			from the output of measuring instruments, from data-loggers connected to electronic sensors and so on, and then used for the following learning phases;
			but since the focus here is the regression itself and not the approximation of a real phenomenon, the datasets used in this post have been synthetically generated from mathematical functions:
			this has the advantage of being able to stress the algorithm and see for which types of datasets the algorithm has acceptable accuracy and for which the algorithm is struggling. 
		</p>

		<h2>Complete sequence of steps</h2>
		<p>
			Launch the <a href="https://www.cs.waikato.ac.nz/ml/weka/" target="_blank">Weka</a> program of the University of Waikato (New Zealand);
			in this post the version of Weka used is 3.8.3, but what I said also works with previous versions; Weka requires that the <a href="https://www.java.com/" target="_blank">Java</a> runtime is installed correctly.<br/>
			After the Weka program is launched, the following window appears:
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/weka-main.png" /></div>
			press the <em>Explorer</em> button highlighted in red.<br />
			When the <em>Weka Explorer</em> window is displayed:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/weka-explorer.png" /></div>
			press the <em>Open Url...</em> button, highlighted in red, to load the dataset in .arff format
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-load-learnds.png" /></div>
			paste the dataset url <a href="https://raw.githubusercontent.com/ettoremessina/datasets/master/functions//RtoR/002/learnds.arff" target="_blank">002/learnds.arff</a> and press <em>Ok</em>.<br />
			The loaded synthetic dataset is generated with the sinusoid function $f(x)=\sin x$ within the interval $[-2 \pi, 2 \pi]$;
			the <em>Weka Explorer</em> window (located on the <em>Preprocess</em> tab) looks like this:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-explorer-processes.png" /></div>
			For the purposes of the objectives of this post we can ignore this tab, then open the <em>Classify</em> tab
			as highlighted in red and the user interface appears like this:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-explorer-classify.png" /></div>
			To choose the regression algorithm in question, press the <em>Choose</em> button and this popup is shown on the screen:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-explorer-classify-choose.png" /></div>
			and choose the <em>SMOreg</em> regressor under the <em>functions</em> category; the user interface looks like this:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-explorer-classify-smoreg.png" /></div>
			Then press the SMOreg label to configure the parameters of the regression algorithm <em>Sequential Minimal Optimization</em> (abbreviated SMO):
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-smoreg-params.png" /></div>
			To choose the PUK algorithm press the bottome <em>Choose</em> and this popup is shown on the screen:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-smoreg-params-choose.png" /></div>
			and choose the PUK algorithm and the previous window becomes like this:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-explorer-classify-smoreg-puk.png" /></div>
			Select the radiobox <em>Using training set</em> to tell Weka to use all the data in the dataset (the learnds.arff file loaded before) for learning,
			then press the <em>Start</em> button to perform the learning; after a few seconds of processing the right part of the window shows the learning metrics:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-explorer-classify-trained1.png" /></div>
			Note that the mean square error is 0.0022, which is a very interesting value.<br />
			To apply the test dataset to this newly trained model select the radiobox <em>Supplied test set</em>
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-explorer-classify-test1.png" /></div>
			to press the <em>Set..</em> button as highlighted in red; the following popup is shown:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-test-instances.png" /></div>
			Press the <em>Open URL...</em> key; the following window appears:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-test-instances-url.png" /></div>
			paste the dataset url <a href="https://raw.githubusercontent.com/ettoremessina/datasets/master/functions//RtoR/002/testds.arff" target="_blank">002/testds.arff</a> and press <em>Ok</em>.<br />
			The caller window shows general information about the test dataset:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-test-instances-after.png" /></div>
			and by pressing <em>Close</em> you return to the <em>Weka explorer</em> window (always in the <em>Classify</em> tab):
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-explorer-classify-test1-bis.png" /></div>
			and press the bottome <em>More options...</em> and the following popup appears:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-more-options.png" /></div>
			press <em>Choose</em> under <em>Output predictions</em> and appears:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-more-options.png" /></div>
			press <em>Choose</em> under <em>Output predictions</em> and the tree popup appears:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-more-options-csv.png" /></div>
			where you have to choose <em>CSV</em> and return to the calling window (the <em>More options</em>):
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-more-options-csv-bis.png" /></div>
			and click on the CSV label to set two options:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-more-options-csv-prop.png" /></div>
			namely:
			<ul>
				<li>in <em>attributes</em> enter the value <em>1</em> to write in the output cvs file also the value of the independent variable $x$</li>
				<li>in <em>outputFile</em> enter the path to the csv file that Weka will create/overwrite when the test dataset is applied to the learned model.</li>
			</ul>
			Then press <em>Ok</em> and you return to the <em>Classifier evaluation options</em> window:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-more-options-csv-ter.png" /></div>
			and by pressing <em>Ok</em> you return to the <em>Weka explorer</em> window (always in the <em>Classify</em> tab).
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-explorer-classify-test1-ter.png" /></div>
			At this point you are ready to apply the test dataset (the testds.arff file loaded first) to the trained model;<br />
			press the right button of the mouse on the model and on the menu that opens choose <em>Re-evaluate model on current test set</em>:
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-explorer-classify-test1-evaluate.png" /></div>
			After a few seconds of processing the right part of the window shows the metrics of the test dataset application to the model;<br />
			the mean square error is 0.0022, which is a very interesting value; the final part of the csv file is visible in the same area;
			by scrolling the area you can see the entire csv file, which however has been saved to disk (setting <em>Output predictions</em>).
		</p>
		<p>
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-weka-explorer-classify-test1-post-evaluate.png" /></div>
			The generated csv file contains 5 columns:
			<ul>
				<li><b>inst#</b>&nbsp;the index of line 1-based (remember that the first line of the file is the header and is to be considered as line 0)</li>
				<li><b>actual</b>&nbsp;the value of the dependent variable of the test dataset</li>
				<li><b>predicted</b>&nbsp;the corresponding value calculated by the model</li>
				<li><b>error</b>&nbsp;the difference between present value and predicted value</li>
				<li><b>X</b>&nbsp;the value of the independent variable $x$</li>
			</ul>
		</p>
		<p>
			With any system of Cartesian charts from csv files plot the X/Y scatter charts of the pairs:
			<ul>
				<li><b>X</b> and <b>actual</b></li>
				<li><b>X</b> and <b>predicted</b></li>
			</ul>			
		</p>
		<p>
			Microsoft Excel has been used here, but any equivalent software or even an online web service is fine; the result is as follows:
			<div class="betweentextlines"><img src="../../posts/machine-learning/weka-smo-puk-regression/002-scatter.png" /></div>
			and as you can see the orange dots (the predicted ones) cover almost perfectly the blue dots (the test data), a sign that the regression had an excellent outcome.
		</p>

		<h2>Alternatives</h2>
		<p>
			For examples of polynominal approximation in .NET see <a href="../../en/machine-learning/polynomial-regression-with-accord-net.html">Polynomial regression with Accord.NET</a>.<br />
			For more information on the approximation of a real function of a variable with an MLP see <a href="../../en/neural-networks/one-variable-real-function-fitting-with-tensorflow.html">One-variable real-valued function fitting with TensorFlow</a> and <a href="../../en/neural-networks/one-variable-real-function-fitting-with-pytorch.html">One-variable real-valued function fitting with PyTorch</a>.<br />
		</p>
	</section>

						</div>
				</div>
				<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">
							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<div class="align-center"><img src="../../images/cm-logo-small.png" alt="Computational&nbsp;Mindset" /></div>
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="../../en/">Home</a></li>
										<li>
											<span class="opener">Neural&nbsp;Networks</span>
											<ul>
												<li><a href="../../en/neural-networks/">INDEX</a></li>
												<li><a href="../../en/neural-networks/differential-equations-and-neural-networks.html">Differential Equations and Neural Networks</a></li>
												<li><a href="../../en/neural-networks/univariate-equally-spaced-time-series-forecast-with-tensorflow.html">Forecast of a univariate equally spaced time series with TensorFlow</a></li>
												<li><a href="../../en/neural-networks/fitting-with-multi-layer-perceptrons-highly-configurable.html">Fitting with highly configurable multi layer perceptrons</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Quantum&nbsp;Computing</span>
											<ul>
												<li><a href="../../en/quantum-computing/">INDEX</a></li>
												<li><a href="../../en/quantum-computing/not-cnot-operators.html">NOT and C-NOT quantum gates</a></li>
												<li><a href="../../en/quantum-computing/random-number-generation.html">Random Numbers Generation</a></li>
												<li><a href="../../en/quantum-computing/hadamard-gate-cascade.html">Cascade Hadamard Gates</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Machine&nbsp;Learning</span>
											<ul>
												<li><a href="../../en/machine-learning/">INDEX</a></li>
												<li><a href="../../en/machine-learning/fitting-with-configurable-xgboost.html">Fitting functions with a configurable XGBoost regressor</a></li>
												<li><a href="../../en/machine-learning/fitting-with-configurable-svr.html">Fitting functions with a configurable Support Vector Regressor</a></li>
												<li><a href="../../en/machine-learning/polynomial-regression-with-accord-net.html">Polynomial regression with Accord.NET</a></li>
												<li><a href="../../en/machine-learning/smo-regression-with-puk-kernel-in-weka.html">SMO regression for SVM with PUK kernel in Weka</a></li>
												<li><a href="../../en/machine-learning/smo-forecast-with-poly-kernel-in-weka.html">SMO forecast for SVM with polynomial kernel in Weka</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Mathematics</span>
											<ul>
												<li><a href="../../en/mathematics/">INDEX</a></li>
												<li><a href="../../en/mathematics/integral-calculus-in-python.html">Integral Calculus in Python</a></li>
												<li><a href="../../en/mathematics/analyzer-of-a-constant-coefficient-linear-and-homogeneous-dynamical-system-on-plane.html">Analyzer of a constant coefficient linear and homogeneous dynamical system on plane</a></li>
												<li><a href="../../en/mathematics/analyzer-of-a-nonlinear-autonomous-dynamical-system-on-plane-by-hartman-grobman-theorem.html">Analyzer of a nonlinear autonomous dynamical system on the plane by Hartman-Grobman theorem</a></li>
												<li><a href="../../en/mathematics/experiments-with-sympy-to-solve-odes-1st-order.html">Experiments with SymPy to solve first-order ordinary differential equations</a></li>
												<li><a href="../../en/mathematics/method-solving-first-order-dde-using-lambert-w-function.html">A method to solve first-order time delayed differential equation using Lambert W function</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Datasets</span>
											<ul>
												<li><a href="../../en/datasets/">INDEX</a></li>
												<li><a href="../../en/datasets/functions-dataset.html">&apos;Functions&apos; dataset collection</a></li>
												<li><a href="../../en/datasets/time-series-dataset.html">&apos;Time&nbsp;Series&apos; dataset collection</a></li>
												<li><a href="../../en/datasets/synthetic-words-dataset.html">&apos;Synthetic Words&apos; dataset</a></li>
											</ul>
										</li>
										<li><a href="../../en/info.html">Info</a></li>
									</ul>
								</nav>

							<!-- Section -->
								<section>
                                    <div class="side-topics">
                                        <header class="align-center">
                                            <h2><a href="../../en/neural-networks/">Neural&nbsp;Networks</a></h2>
                                        </header>
                                        <article>
                                            <a href="../../en/neural-networks/" class="image"><span class="icon solid fa-sitemap"/></a>
                                        </article>
                                        <header class="align-center">
                                            <h2><a href="../../en/quantum-computing/">Quantum&nbsp;Computing</a></h2>
                                        </header>
                                        <article>
                                            <a href="../../en/quantum-computing/" class="image"><span class="icon solid fa-atom" /></a>
                                        </article>
                                    </div>
								</section>

							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">
										Design based on &apos;Editorial&apos; template (with customization) downloaded from <a href="https://html5up.net" target="_blank">HTML5 UP</a>.
										<br/>
										Click on links to see <a href="../../html5up-license/LICENSE.txt" target="_blank">LICENSE.txt</a> and <a href="../../html5up-license/README.txt" target="_blank">README.txt</a> files of &apos;Editorial&apos; template by HTML5 UP.
										<br>
										<br>
										&copy; <a href="../../en/info.html">Ettore Messina</a>. 
									</p>
								</footer>
						</div>
					</div>
			</div>

		<!-- Scripts -->
			<script src="../../assets/js/jquery.min.js"></script>
			<script src="../../assets/js/browser.min.js"></script>
			<script src="../../assets/js/breakpoints.min.js"></script>
			<script src="../../assets/js/util.js"></script>
			<script src="../../assets/js/main.js"></script>

			<style>
				a.cc-link
				{
				    border-bottom: none;
				}
				a.cc-link:hover
				{
					color: white !important;
				}
			</style>
	</body>
</html>

