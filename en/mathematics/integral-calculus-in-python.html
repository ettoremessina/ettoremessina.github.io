





<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head lang="en">
		<meta http-equiv="content-language" content="en">
		<meta name="author" content="Ettore Messina">	

		<style>
			#cookiescript_checkbox_input {
				-moz-appearance: checkbox;
				-webkit-appearance: checkbox;
				-ms-appearance: checkbox;
				appearance: checkbox;
				opacity: 1.0;
			}
			#cookiescript_checkbox_text {
				color: white;
			}
			#cookiescript_description a:hover {
				color: yellow !important;
			}
		</style>
		<script type="text/javascript" charset="UTF-8" src="https://cookie-script.com/s/19e1626ea9f21a6fcc285b559b5957e6.js"></script>


		<title>Integral Calculus in Python</title>
		<meta name="description" content="Examples of using common Python libraries to calculate numerically (with SciPy) and analytically (with SymPy) the value of different types of integrals." >
		<meta name="keywords" content="integral, integrals, integral calculus, quad, dblquad, tplquad, nquad, fixed_quad, quadrature, romberg, trapezoid, simpson, integrate, NumPy, SciPy, SymPy, Python" >
		<link rel="canonical" href="https://computationalmindset.com/en/mathematics/integral-calculus-in-python.html" />
		<link rel="alternate" hreflang="en" href="https://computationalmindset.com/en/mathematics/integral-calculus-in-python.html" />
		<link rel="alternate" hreflang="it" href="https://computationalmindset.com/it/matematica/calcolo-integrale-in-python.html" />
		
    <!-- SCHEMA.ORG JSON-LD WEBSITE -->
    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "WebSite",
        "name": "Computational Mindset",
        "url": "https://computationalmindset.com/",
        "sameAs": ["https://www.facebook.com/ComputationalMindset/", "https://github.com/ettoremessina/"],
        "author":
        {
          "@type": "Person",
          "name": "Ettore Messina",
          "image": "https://computationalmindset.com/images/ettore-messina.jpg",
          "gender": "Male",          
          "sameAs": ["https://www.facebook.com/ettore.messina.73/", "https://www.instagram.com/etmessina/", "https://twitter.com/ettoremessina/", "https://twitter.com/Computational_M/", "https://github.com/ettoremessina/", "https://medium.com/@ettoremessina/", "https://www.linkedin.com/in/ettoremessina", "https://www.linkedin.com/company/computational-mindset", "https://ettoremessina.tech/"]
        }
    }
    </script>

		
    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement":
        [
		
          {
            "@type": "ListItem",
            "position": 1,
            "item":
            {
                "@id": "https://computationalmindset.com/en/",
                "name": "Computational Mindset"
            }
          },
		
          {
            "@type": "ListItem",
            "position": 2,
            "item":
            {
              "@id": "https://computationalmindset.com/en/mathematics/",
              "name": "Mathematics"
            }
          },

          {
            "@type": "ListItem",
            "position": 3,
            "item":
            {
              "@id": "https://computationalmindset.com/en/mathematics/integral-calculus-in-python.html",
              "name": "Integral Calculus in Python"
            }
		  }
		
        ]
    }
    </script>
		

		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/railscasts.min.css">
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
		
		<script>hljs.initHighlightingOnLoad();</script>
		<style>
			pre > code 
			{
				font-size: 1.2em;
			}
		</style>

		
		<script type="text/x-mathjax-config">
			MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
		</script>
		<script type="text/javascript"
			src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>

		<!-- OPEN GRAPH PROTOCOL --------------------------------------------------------------------->
		<meta property="og:url" content="https://computationalmindset.com/en/mathematics/integral-calculus-in-python.html" />
		<meta property="og:type" content="article" />
		<meta property="og:title" content="" />
		<meta property="og:description" content="" />
		<meta property="og:image" content="/social-previews/thumbnail4.jpg" />
		<!-- OPEN GRAPH PROTOCOL --------------------------------------------------------------------->        


		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../../assets/css/main.css" />
		<link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon" />
		<link rel="icon" href="../../favicon.ico" type="image/x-icon" />
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a href="../../en/info.html" class="logo"><strong>Computational&nbsp;Mindset</strong> by&nbsp;Ettore&nbsp;Messina</a>
									<div style="text-align:right">
										<a class="logo" href="../../en/">en</a>
										&nbsp;&nbsp;&nbsp;
										<a class="logo" href="../../it/">it</a>
									</div>
									<ul class="icons">
										<li><a href="https://github.com/ettoremessina/" class="icon brands fa-github" target="_blank"><span class="label">GitHub</span></a></li>
										<li><a href="https://www.linkedin.com/company/computational-mindset" class="icon brands fa-linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
										<li><a href="https://twitter.com/Computational_M/" class="icon brands fa-twitter" target="_blank"><span class="label">Twitter</span></a></li>
										<li><a href="https://www.facebook.com/ComputationalMindset/" class="icon brands fa-facebook-f" target="_blank"><span class="label">Facebook</span></a></li>
										<li><a href="https://www.youtube.com/c/ComputationalMindset" class="icon brands fa-youtube" target="_blank"><span class="label">YouTube</span></a></li>
										<li><a href="https://linktr.ee/ComputationalMindset/" class="fas fa-link" style="color: grey;" target="_blank"><span class="label"></span></a></li>
										<li><a href="https://ettoremessina.tech/" class="icon brands fa-wordpress" target="_blank"><span class="label">WordPress</span></a></li>
									</ul>
								</header>

<!-- Content -->
    $\newcommand{\dee}{\mathop{\mathrm{d}\!}}$
	<section>
		<header class="main">
			<h1>Integral Calculus in Python</h1>
		</header>
		<p>
        	This post shows how to perform integral calculus of continuous and limited real functions of real variables in Python
            through the use of common Python libraries frequently used in scientific applications.
            The integral calculation techniques here are both primarily numerical since this site deals with computation,
            however some analytical techniques are also shown.<br />
            The post is organized <em>by examples</em>: each paragraph contains an example of an integral to compute
            and the related Python code snippet that calculates it using an appropriate library.<br />
            <br />
            All of the various code snippets described in this post require Python version 3 and the NumPy library,
            while individually they require an additional library (and its dependencies, if any) between
            <a href="https://www.scipy.org/" target="_blank">SciPy</a> and <a href="https://www.sympy.org/" target="_blank">SymPy</a>.<br/>
			<br />
			We thank Prof. Fausta D&apos;Acunzo of <a href="https://youtube.com/c/Preparazione20" target="_blank">Preparazione 2.0</a> for theoretical support provided on multi-variable integral calculus.<br />
			<br/>
			To get the code see the <a href="#downloadcode">Full code download</a> paragraph at the bottom of this post.<br/>
			<br/>
        </p>

        <h2>Integration via SciPy</h2>

		<h3 id="int1vexp1_scipy">Integral of function of one variable (with finite extremes)</h3>
		<p>
			In integral calculus, the definite integral is an operator that, given a real-valued function of a real-valued variable and an interval $[a,b]$ (subset of the domain),
            associates to the function the area subtended by its graph in the interval $[a,b]$.<br />
            The <em>SciPy</em> library provides several numerical methods for computing the integral of such functions;
            the purpose of this chapter is to present a series of demos to show &quot;by examples&quot; the use of such methods;
            for complete documentation of these methods, the reader is invited to consult the official documentation of <em>SciPy</em>.<br />
			<br />
            Let the following integral of a function of one variable be given:
            
            $$ \int_{1}^{5} 2 x e^{-x} \,dx $$

            whose analytical solution is
            $ \approx 1.3907 $
            verifiable online via <a href="https://www.wolframalpha.com/input/?i=integrate+2+x+e%5E-x+from+1+to+5" target="_brank">Wolfram Alpha</a>.<br />
		</p>

		<h4 id="int1vexp1_scipy">Calculating the integral with <em>quad</em></h4>
		<p>
            Below is the example of Python code that calculates the integral using
            the <code>quad</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Single integral computed by SciPy quad')
print('Example 1-01 quad')
print('Integral of 2xe^-x from x=1 to x=5')

integrand = lambda x : 2 * x * np.exp(-x)
a = 1.
b = 5.

result, error = spi.quad(integrand, a, b)
print('Result is ', result, 'with error ', error)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Single integral computed by SciPy quad
Example 1-01 quad
Integral of 2xe^-x from x=1 to x=5
Result is  1.3906624006967436 with error  1.54394541673402e-14
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr1-01-quad.py">GitHub</a>.
        </p>

        <h4 id="int1vexp1_scipy_fixed_quad">Calculating the integral with <em>fixed_quad</em></h4>
		<p>
            Below is the example of Python code that calculates the integral using
            the <code>fixed_quad</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Single integral computed by SciPy fixed_quad')
print('Example 1-01 fixed_quad')
print('Integral of 2xe^-x from x=1 to x=5')

integrand = lambda x : 2 * x * np.exp(-x)
a = 1.
b = 5.

result, none = spi.fixed_quad(integrand, a, b, n=5)
print('Result is ', result)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Single integral computed by SciPy fixed_quad
Example 1-01 fixed_quad
Integral of 2xe^-x from x=1 to x=5
Result is  1.39066368239563
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr1-01-fixed_quad.py">GitHub</a>.
        </p>

        <h4 id="int1vexp1_scipy_quadrature">Calculating the integral with <em>quadrature</em></h4>
		<p>
            Below is the example of Python code that calculates the integral using
            the <code>quadrature</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Single integral computed by SciPy quadrature')
print('Example 1-01 quadrature')
print('Integral of 2xe^-x from x=1 to x=5')

integrand = lambda x : 2 * x * np.exp(-x)
a = 1.
b = 5.

result, error = spi.quadrature(integrand, a, b)
print('Result is ', result, 'with error ', error)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Single integral computed by SciPy quadrature
Example 1-01 quadrature
Integral of 2xe^-x from x=1 to x=5
Result is  1.3906624007789083 with error  1.225092050027854e-08
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr1-01-quadrature.py">GitHub</a>.
        </p>

        <h4 id="int1vexp1_scipy_romberg">Calculating the integral with <em>romberg</em></h4>
		<p>
            Below is the example of Python code that calculates the integral using
            the <code>romberg</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Single integral computed by SciPy romberg')
print('Example 1-01 romberg')
print('Integral of 2xe^-x from x=1 to x=5')

integrand = lambda x : 2 * x * np.exp(-x)
a = 1.
b = 5.

result = spi.romberg(integrand, a, b)
print('Result is ', result)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Single integral computed by SciPy romberg
Example 1-01 romberg
Integral of 2xe^-x from x=1 to x=5
Result is  1.3906624006967394
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr1-01-romberg.py">GitHub</a>.
        </p>

        <h4 id="int1vexp1_scipy_trapezoid">Calculating the integral with <em>trapezoid</em></h4>
		<p>
            The <code>trapezoid</code> function is a fixed-sample function integration method,
            so the code first discretizes the integration interval evenly spaced and
            for all discrete values of $x$ it computes the corresponding values of $y$
            and then passes the two sets of discrete values $x$ and $y$ to the integration method.<br />
            <br />
            Below is the example of Python code that calculates the integral using
            the <code>trapezoid</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Single integral computed by SciPy trapezoid')
print('Example 1-01 trapezoid')
print('Integral of 2xe^-x from x=1 to x=5')

integrand = lambda x : 2 * x * np.exp(-x)
a = 1.
b = 5.
step = 1e-4

xs = np.arange(a, b, step)
ys = integrand(xs)

result = spi.trapezoid(ys, xs)
print('Result is ', result)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Single integral computed by SciPy trapezoid
Example 1-01 trapezoid
Integral of 2xe^-x from x=1 to x=5
Result is  1.3906556624352673
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr1-01-trapezoid.py">GitHub</a>.
        </p>

        <h4 id="int1vexp1_scipy_cumulative_trapezoid">Calculating the integral with <em>cumulative_trapezoid</em></h4>
		<p>
            The function <code>cumulative_trapezoid</code> is also a fixed-sample function integration method,
            and so what was said about <code>trapezoid</code> applies.
            <br />
            Below is the example of Python code that calculates the integral using
            of the <code>cumulative_trapezoid</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Single integral computed by SciPy cumulative_trapezoid')
print('Example 1-01 cumulative_trapezoid')
print('Integral of 2xe^-x from x=1 to x=5')

integrand = lambda x : 2 * x * np.exp(-x)
a = 1.
b = 5.
step = 1e-4

xs = np.arange(a, b, step)
ys = integrand(xs)

result = spi.cumulative_trapezoid(ys, xs)
result = result[-1]
print('Result is ', result)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Single integral computed by SciPy cumulative_trapezoid
Example 1-01 cumulative_trapezoid
Integral of 2xe^-x from x=1 to x=5
Result is  1.3906556624352677
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr1-01-cumulative-trapezoid.py">GitHub</a>.
        </p>

        <h4 id="int1vexp1_scipy_simpson">Calculating the integral with <em>simpson</em></h4>
		<p>
            The function <code>simpson</code> is also a fixed-sample function integration method,
            and so what was said about <code>trapezoid</code> applies.
            <br />
            Below is the example of Python code that calculates the integral using
            the <code>simpson</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Single integral computed by SciPy simpson')
print('Example 1-01 simpson')
print('Integral of 2xe^-x from x=1 to x=5')

integrand = lambda x : 2 * x * np.exp(-x)
a = 1.
b = 5.
step = 1e-4

xs = np.arange(a, b, step)
ys = integrand(xs)

result = spi.simpson(ys, xs)
print('Result is ', result)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Single integral computed by SciPy simpson
Example 1-01 simpson
Integral of 2xe^-x from x=1 to x=5
Result is  1.3906556624801614
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr1-01-simpson.py">GitHub</a>.
        </p>

		<h3 id="int1vexp2_quadscipy">Integral of function of one variable with <em>quad</em> (with extreme infinity)</h3>
		<p>
            Set the following integral of a function of one variable be given:
            
            $$ \int_{1}^{+\infty} 2 x e^{-x} \,dx $$

            whose analytical solution is
            $ \approx 1.4715 $
            verifiable online via <a href="https://www.wolframalpha.com/input/?i=integrate+2+x+e%5E-x+from+1+to+infinite" target="_brank">Wolfram Alpha</a>.<br />
            <br />
            Below is the example of Python code that calculates the integral using
            the <code>quad</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Single integral computed by SciPy quad')
print('Example 1-02 quad')
print('Integral of 2xe^-x from x=1 to x-->+inf')

integrand = lambda x : 2 * x * np.exp(-x)
a = 1.
b = np.inf

result, error = spi.quad(integrand, a, b)
print('Result is ', result, 'with error ', error)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Single integral computed by SciPy quad
Example 1-02 quad
Integral of 2xe^-x from x=1 to x-->+inf
Result is  1.4715177646857691 with error  3.7568301883294814e-10
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr1-02-quad.py">GitHub</a>.
        </p>

		<h3 id="int1vexp34_scipy">Calculation of the length of a planar curve arc</h3>
		<p>
            As is well known, the integrals of a function of one variable can also be used to calculate the length of an arc of a planar curve.
            If the curve is expressed in the form $y=f(x)$ and is continuous and derivable
            the formula for calculating the length of the;arc of the curve between $ x=a $ and $ x=b $ is as follows:
            $$ \int_{a}^{b} \sqrt{1 + \left(\frac{\,dy}{\,dx}\right)^2} \,dx $$
            <br />
            If instead curve is expressed in the parametric form $x=f_x(t)$ and $y=f_y(t)$
            with both $f_x$ and $f_y$ continuous and derivable,
            the formula for calculating the length of the arc of the curve between $ t=a $ and $ t=b $ is as follows:
            $$ \int_{a}^{b} \sqrt{\left(\frac{\,dx}{\,dt}\right)^2 + \left(\frac{\,dy}{\,dt}\right)^2} \,dt $$
            <br />
            <b>Note</b>: in the two examples that follow, the prime derivatives are calculated using the <em>AutoGrad</em> library.
        </p>

        <h4 id="int1vexp3_scipyarclength">Calculation of the length of a planar curve arc expressed in explicit form with <em>quad</em></h4>
		<p>
            Let the following planar curve be given in explicit form:
            
            $$ y=e^{-x^2} $$

            by applying the corresponding formula above to calculate the length of the arc between $ x=-1 $ and $ x = 1 $, the integral is obtained:
            
            $$ \int_{-1}^{1} \sqrt{1 + \left(\frac{\,d(e^{-x^2})}{\,dx}\right)^2} \,dx $$

            whose analytical solution is
            $ \approx 2.4089 $
            verifiable online via <a href="https://www.wolframalpha.com/input/?i=length+of+e%5E-x%5E2+for+x%3D-1+to+x%3D1&lk=3" target="_brank">Wolfram Alpha</a>.<br />
            <br />
            Here is the example of Python code that calculates length of a planar curve arc expressed in explicit form using
            the <code>quad</code> function of <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import autograd.numpy as anp   # Thinly-wrapped version of Numpy
import autograd as ag

print('Compute length of an arc of planar curve by SciPy quad')
print('Example 1-03 quad arclength')
print('Length of arc of curve y=e^(-x^2) from x=-1 to x=1')

y = lambda x : anp.exp(-x**2)
dy_dx = ag.grad(y)
integrand = lambda x : anp.sqrt(1 + dy_dx(x) ** 2)
a = -1.
b = 1.

result, error = spi.quad(integrand, a, b)
print('Result is ', result, 'with error ', error)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Compute length of an arc of planar curve by SciPy quad
Example 1-03 quad arclength
Length of arc of curve y=e^(-x^2) from x=-1 to x=1
Result is  2.408882141747104 with error  1.3501578327579367e-12
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr1-03-quad-arclength.py">GitHub</a>.
        </p>

        <h4 id="int1vexp4_scipyarclength">Calculation of the length of a planar curve arc expressed in parametric form with <em>quad</em></h4>
		<p>
            Let the following planar curve be given in parametric form:
            
            $$ x(t)=cos^3 t $$
            $$ y(t)=sin^3 t $$

            by applying the corresponding formula above to calculate the length of the arc between $ t=0 $ e $ t = 2\pi $, the integral is obtained:
            
            $$ \int_{0}^{2 \pi} \sqrt{\left(\frac{\,d (cos^3 t)}{\,dt}\right)^2 + \left(\frac{\,d (sin^3 t)}{\,dt}\right)^2} \,dt $$

            whose analytical solution is
            $ 6 $
            verifiable online via <a href="https://www.wolframalpha.com/input/?i=arclength+x%28t%29%3Dcos%5E3+t%2C+y%28t%29%3Dsin%5E3+t+for+t%3D0+to+2pi&lk=3" target="_brank">Wolfram Alpha</a>.<br />
            <br />
            Here is the example of Python code that calculates length of a planar curve arc expressed in parametric form using
            the <code>quad</code> function of <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import autograd.numpy as anp   # Thinly-wrapped version of Numpy
import autograd as ag

print('Compute length of an arc of planar parametric curve by SciPy quad')
print('Example 1-04 quad arclength')
print('Length of arc of parametric curve x(t)=cos^3(t) and y(t)=sin^3(t) from t=0 to t=2pi')

x = lambda t : anp.cos(t) ** 3
y = lambda t : anp.sin(t) ** 3
dx_dt = ag.grad(x)
dy_dt = ag.grad(y)

integrand = lambda t : anp.sqrt(dx_dt(t) ** 2 + dy_dt(t) ** 2)
a = 0.
b = 2 * anp.pi

result, error = spi.quad(integrand, a, b)
print('Result is ', result, 'with error ', error)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Compute length of an arc of planar parametric curve by SciPy quad
Example 1-04 quad arclength
Length of arc of parametric curve x(t)=cos^3(t) and y(t)=sin^3(t) from t=0 to t=2pi
Result is  6.0 with error  6.616929226765933e-14
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr1-04-quad-arclength.py">GitHub</a>.
        </p>

		<h3 id="int2vexp1_scipy">Double integral of a function of two variables</h3>
		<p>
            In integral calculus, the definite double integral is an operator that, given a real-valued function of two real-valued variables and a set included in the domain,			
            associates to the function the volume of the solid (called cylindroid) between the surface described by the function and the plane containing the given set.<br />
            <br />
            Let the following double integral of a function of two variables be given:
            
            $$ \int_{1}^{5} \int_{y-1}^{y+1} 2 x y e^{-x y} \,dx dy $$

            whose analytical solution is
            $ \approx 1.0273 $
            verifiable online via <a href="https://www.wolframalpha.com/input/?i=double+integral+2+x+y+e%5E-%28x+*+y%29+dx+dy+from+1+to+5+and+y-1+to+y%2B1" target="_brank">Wolfram Alpha</a>.<br />
		</p>

		<h4 id="int2vexp1_scipydblquad">Calculating the integral with <em>dblquad</em></h4>
		<p>
            Below is the example of Python code that calculates the integral using
            the <code>dblquad</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Double integral computed by SciPy dblquad')
print('Example 2-01 dblquad')
print('Integral of 2xye^-xy from y=1 to y=5 and from x=y-1 to x=y+1')

integrand = lambda x, y : 2 * x * y * np.exp(-x * y)
ya = 1.
yb = 5.

result, error = spi.dblquad(integrand, ya, yb, lambda y: y-1, lambda y: y+1)
print('Result is ', result, 'with error ', error)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Double integral computed by SciPy dblquad
Example 2-01 dblquad
Integral of xye^-xy from y=1 to y=5 and from x=y-1 to x=y+1
Result is  1.0273038469260316 with error  1.3420097685964054e-14
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr2-01-dblquad.py">GitHub</a>.
        </p>

		<h4 id="int2vexp1_scipynquad">Calculating the integral with <em>nquad</em></h4>
		<p>
            Below is the example of Python code that calculates the integral using
            the <code>nquad</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Double integral computed by SciPy nquad')
print('Example 2-01 nquad')
print('Integral of 2xye^-xy from y=1 to y=5 and from x=y-1 to x=y+1')

integrand = lambda x, y : 2 * x * y * np.exp(-x * y)

bounds_y = lambda : [1., 5.]
bounds_x = lambda y : [y-1, y+1]

result, error = spi.nquad(integrand, [bounds_x, bounds_y])
print('Result is ', result, 'with error ', error)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Double integral computed by SciPy nquad
Example 2-01 nquad
Integral of 2xye^-xy from y=1 to y=5 and from x=y-1 to x=y+1
Result is  1.0273038469260316 with error  1.3420097685964054e-14
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr2-01-nquad.py">GitHub</a>.
        </p>

		<h3 id="int2vexp1_nquadscipy">Double integral of a function of two variables with <em>nquad</em> (other example)</h3>
		<p>
            Let the following double integral of a function of two variables be given:
            
            $$ \int_{1}^{+\infty} \int_{1}^{+\infty} 2 x y e^{-x y} \,dx dy $$

            whose analytical solution is
            $ \approx 1.17453 $
            verifiable online via <a href="https://www.wolframalpha.com/input/?i=double+integral+2+x+y+e%5E-%28x+*+y%29+dx+dy+from+1+to+%2Binfinite+and+1+to+%2Binfinite" target="_brank">Wolfram Alpha</a>.<br />
            <br />
            Below is the example of Python code that calculates the integral using
            the <code>nquad</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Double integral computed by SciPy nquad')
print('Example 2-02 nquad')
print('Integral of 2xye^-xy from y=1 to x-->+inf and from x=1 to x-->+inf')

integrand = lambda x, y : 2 * x * y * np.exp(-x * y)
ya = 1.
yb = 5.

result, error = spi.nquad(integrand, [[1, np.inf],[1, np.inf]])
print('Result is ', result, 'with error ', error)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Double integral computed by SciPy nquad
Example 2-02 nquad
Integral of 2xye^-xy from y=1 to y-->+inf and from x=1 to x-->+inf
Result is  1.1745267511339024 with error  1.6321550842479074e-08
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr2-02-nquad.py">GitHub</a>.
        </p>

		<h3 id="int3vexp1_scipy">Triple Integral of a function of three variables</h3>
		<p>
            Let the following triple integral of a function of three variables be given:
            
            $$ \int_{1}^{2} \int_{z+1}^{z+2} \int_{y+z}^{2(y+z)} x + yz^2 \,dx dy dz $$

            whose analytical solution is
            $ \approx 65.7194 $
            verifiable online via <a href="https://www.wolframalpha.com/input/?i=triple+integral+x+%2B+y+*+z%5E2+dx+dy+dz+from+1+to+2+and+from+z%2B1+to+z%2B2+and+from+y%2Bz+to+2+*+%28y%2Bz%29" target="_brank">Wolfram Alpha</a>.<br />
        </p>

        <h4 id="int3vexp1_scipytplquad">Calculating the integral with <em>tplquad</em></h4>
		<p>
            Below is the example of Python code that calculates the integral using
            the <code>tplquad</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Triple integral computed by SciPy tplquad')
print('Example 3-01 tplquad')
print('Integral of x + yz^2 from z=1 to z=2, y=z+1 to y=z+2 and from x=y+x to x=2(y+z)')

integrand = lambda x, y, z : x + y * z ** 2
za = 1.
zb = 2.
ya=lambda z: z + 1
yb=lambda z: z + 2
xa=lambda z, y : y + z
xb=lambda z, y : 2 * (y + z)

result, error = spi.tplquad(integrand, za, zb, ya, yb, xa, xb)
print('Result is ', result, 'with error ', error)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Triple integral computed by SciPy tplquad
Example 3-01 tplquad
Integral of x + yz^2 from z=1 to z=2, y=z+1 to y=z+2 and from x=y+x to x=2(y+z)
Result is  65.71944444444445 with error  1.659412309590769e-12
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr3-01-tplquad.py">GitHub</a>.
        </p>

        <h4 id="int3vexp1_scipynquad">Calculating the integral with <em>nquad</em></h4>
		<p>
            Below is the example of Python code that calculates the integral using
            the <code>nquad</code> function of the <em>SciPy</em> library:</br >
            <pre><code class="python">import scipy.integrate as spi
import numpy as np

print('Triple integral computed by SciPy nquad')
print('Example 3-01 nquad')
print('Integral of x + yz^2 from z=1 to z=2, y=z+1 to y=z+2 and from x=y+x to x=2(y+z)')

integrand = lambda x, y, z : x + y * z ** 2

bounds_z = lambda : [1., 2.]
bounds_y = lambda z : [z+1, z+2]
bounds_x = lambda z, y : [y+z, 2 * (y+z)]
ya=lambda z: z + 1
yb=lambda z: z + 2
xa=lambda z, y : y + z
xb=lambda z, y : 2 * (y + z)

result, error = spi.nquad(integrand, [bounds_x, bounds_y, bounds_z])
print('Result is ', result, 'with error ', error)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Triple integral computed by SciPy nquad
Example 3-01 nquad
Integral of x + yz^2 from z=1 to z=2, y=z+1 to y=z+2 and from x=y+x to x=2(y+z)
Result is  65.71944444444445 with error  1.659412309590769e-12
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/scipy/scipy-integr3-01-nquad.py">GitHub</a>.
        </p>

		<h2>Integration via SymPy</h2>

		<h3 id="int1vexp1_sympy">Integral of function of one variable (with finite extremes)</h3>
		<p>
			In integral calculus, the definite integral is an operator that, given a real-valued function of a real-valued variable and an interval $[a,b]$ (subset of the domain),
            associates to the function the area subtended by its graph in the interval $[a,b]$.<br />
            The <em>SciPy</em> library provides several numerical methods for computing the integral of such functions;
            the purpose of this chapter is to present a series of demos to show &quot;by examples&quot; the use of such methods;
            for complete documentation of these methods, the reader is invited to consult the official documentation of <em>SciPy</em>.<br />
			<br />
            Let the following integral of a function of one variable be given:
            
            $$ \int_{1}^{5} 2 x e^{-x} \,dx $$

            whose analytical solution is
            $ \approx 1.3907 $
            verifiable online via <a href="https://www.wolframalpha.com/input/?i=integrate+2+x+e%5E-x+from+1+to+5" target="_brank">Wolfram Alpha</a>.<br />
		</p>

		<h4 id="int1vexp1_sympy">Integral of a function of one variable with <em>integrate(f, (x, a, b))</em></h4>
		<p>
            Below is the example of Python code that calculates the integral using
            the <code>integrate(f, (x, a, b))</code> function of the <em>SymPy</em> library:</br >
            <pre><code class="python">import sympy as sp

print('Single integral computed by SymPy definite integrate')
print('Example 1-01 definite')
print('Integral of 2xe^-x from x=1 to x=5')

x = sp.Symbol('x')
f = 2 * x * sp.exp(-x)
a = 1.
b = 5.
integral = sp.integrate(f, (x, a, b))
integral = integral.evalf()
print('Result is ', integral)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Single integral computed by SymPy definite integrate
Example 1-01 definite
Integral of 2xe^-x from x=1 to x=5
Result is  1.39066240069674
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/sympy/sympy-integr1-01-definite.py">GitHub</a>.
        </p>

		<h4 id="int1vexp1_undef_sympy">Integral of a function of one variable with <em>integrate(f, (x, a, b))</em> via indefinite integral</h4>
		<p>
            Below is the example of Python code that calculates the integral using
            the <code>integrate(f, x)</code> function of the <em>SymPy</em> library:</br >
            <pre><code class="python">import sympy as sp

print('Single integral computed by SymPy indefinite integrate')
print('Example 1-01 indefinite integrate')
print('Integral of 2xe^-x from x=1 to x=5')

x = sp.Symbol('x')
f = 2 * x * sp.exp(-x)
primitive = sp.integrate(f, x)
print('Primitive is ', primitive)

primitive_lambda = sp.lambdify(x, primitive)
a = 1.
b = 5.
integral = primitive_lambda(b) - primitive_lambda(a)
print('Result is ', integral)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Single integral computed by SymPy indefinite integrate
Example 1-01 indefinite integrate
Integral of 2xe^-x from x=1 to x=5
Primitive is  (-2*x - 2)*exp(-x)
Result is  1.3906624006967436
</code></pre>
            The program first calculates the indefinite integral and then
            applying the fundamental theorem of integral calculus,
            calculates the value of the integral.<br />
            <br />
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/sympy/sympy-integr1-01-indefinite-integrate.py">GitHub</a>.
        </p>

		<h3 id="int2vexp1_sympy">Double integral of a function of two variables</h3>
		<p>
            In integral calculus, the definite double integral is an operator that, given a real-valued function of two real-valued variables and a set included in the domain,			
            associates to the function the volume of the solid (called cylindroid) between the surface described by the function and the plane containing the given set.<br />
            <br />
            Let the following double integral of a function of two variables be given:
            
            $$ \int_{1}^{4} \int_{y-1}^{y+2} x y e^{-x} e^{-y} \,dx dy $$

            whose analytical solution is
            $ \approx 0.396134 $
            verifiable online via <a href="https://www.wolframalpha.com/input/?i=double+integral+x+y+e%5E-x+e%5E-y+dx+dy+from+0+to+4+and+from+y-1+to+y%2B1" target="_brank">Wolfram Alpha</a>.<br />
		</p>

		<h4 id="int2vexp3_sympy">Double Integral of a function of two variables with <em>integrate(f, (x, xa, xb), (y, ya, yb))</em></h4>
		<p>
            Below is the example of Python code that calculates the integral using
            the <code>integrate(f, (x, xa, xb), (y, ya, yb))</code> of the <em>SymPy</em> library:</br >
            <pre><code class="python">import sympy as sp

print('Double integral computed by SymPy definite integrate')
print('Example 2-03 definite')
print('Integral of xye^-xy from y=1 to y=4 and from x=y-1 to x=y+1')

x, y = sp.symbols('x y')
f = x * y * sp.exp(-x) * sp.exp(-y)
ya = 0.
yb = 4.
xa = y-1.
xb = y+1.

integral = sp.integrate(f, (x, xa, xb), (y, ya, yb))
integral = integral.evalf()
print('Result is ', integral)
</code></pre>
            whose output is:<br />
            <br />
            <pre><code class="shell">Double integral computed by SymPy definite integrate
Example 2-03 definite
Integral of xye^-xy from y=1 to y=4 and from x=y-1 to x=y+1
Result is  0.396134380699524
</code></pre>
            Here is the link to the code on <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/blob/main/demo/python/sympy/sympy-integr2-03-definite.py">GitHub</a>.
        </p>

		<h2 id="downloadcode">Download of the complete code</h2>
		<p>
			The complete code is available at <a target="_blank" href="https://github.com/ettoremessina/integral-calculus/tree/main/demo/python/">GitHub</a>.
			<br/>
			
			These materials are distributed under MIT license; feel free to use, share, fork and adapt these materials as you see fit.
			<br/>
			Also please feel free to submit pull-requests and bug-reports to this GitHub repository or contact me on my social media channels available on the top right corner of this page.
			<br/>

		</p>

	</section>

						</div>
				</div>
				<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">
							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<div class="align-center"><img src="../../images/cm-logo-small.png" alt="Computational&nbsp;Mindset" /></div>
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="../../en/">Home</a></li>
										<li>
											<span class="opener">Neural&nbsp;Networks</span>
											<ul>
												<li><a href="../../en/neural-networks/">INDEX</a></li>
												<li><a href="../../en/neural-networks/pruning-of-neural-networks-with-tensorflow.html">Pruning of neural networks with TensorFlow</a></li>
												<li><a href="../../en/neural-networks/differential-equations-and-neural-networks.html">Differential Equations and Neural Networks</a></li>
												<li><a href="../../en/neural-networks/univariate-equally-spaced-time-series-forecast-with-tensorflow.html">Forecast of a univariate equally spaced time series with TensorFlow</a></li>
												<li><a href="../../en/neural-networks/fitting-with-multi-layer-perceptrons-highly-configurable.html">Fitting with highly configurable multi layer perceptrons</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Quantum&nbsp;Computing</span>
											<ul>
												<li><a href="../../en/quantum-computing/">INDEX</a></li>
												<li><a href="../../en/quantum-computing/not-cnot-operators.html">NOT and C-NOT quantum gates</a></li>
												<li><a href="../../en/quantum-computing/random-number-generation.html">Random Numbers Generation</a></li>
												<li><a href="../../en/quantum-computing/hadamard-gate-cascade.html">Cascade Hadamard Gates</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Machine&nbsp;Learning</span>
											<ul>
												<li><a href="../../en/machine-learning/">INDEX</a></li>
												<li><a href="../../en/machine-learning/common-tools-for-function-fitting.html">Common tools for function fitting</a></li>
												<li><a href="../../en/machine-learning/fitting-functions-with-pycaret.html">Fitting functions with PyCaret</a></li>
												<li><a href="../../en/machine-learning/fitting-with-configurable-xgboost.html">Fitting functions with a configurable XGBoost regressor</a></li>
												<li><a href="../../en/machine-learning/fitting-with-configurable-svr.html">Fitting functions with a configurable Support Vector Regressor</a></li>
												<li><a href="../../en/machine-learning/polynomial-regression-with-accord-net.html">Polynomial regression with Accord.NET</a></li>
												<li><a href="../../en/machine-learning/smo-regression-with-puk-kernel-in-weka.html">SMO regression for SVM with PUK kernel in Weka</a></li>
												<li><a href="../../en/machine-learning/smo-forecast-with-poly-kernel-in-weka.html">SMO forecast for SVM with polynomial kernel in Weka</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Mathematics</span>
											<ul>
												<li><a href="../../en/mathematics/">INDEX</a></li>
												<li><a href="../../en/mathematics/fourier-series-in-python.html">Fourier Series in Python</a></li>
												<li><a href="../../en/mathematics/solving-delay-differential-equations-in-python-using-numerical-methods.html">Solving delay differential equations using numerical methods in Python</a></li>
												<li><a href="../../en/mathematics/integral-calculus-in-python.html">Integral Calculus in Python</a></li>
												<li><a href="../../en/mathematics/analyzer-of-a-constant-coefficient-linear-and-homogeneous-dynamical-system-on-plane.html">Analyzer of a constant coefficient linear and homogeneous dynamical system on plane</a></li>
												<li><a href="../../en/mathematics/analyzer-of-a-nonlinear-autonomous-dynamical-system-on-plane-by-hartman-grobman-theorem.html">Analyzer of a nonlinear autonomous dynamical system on the plane by Hartman-Grobman theorem</a></li>
												<li><a href="../../en/mathematics/experiments-with-sympy-to-solve-odes-1st-order.html">Experiments with SymPy to solve first-order ordinary differential equations</a></li>
												<li><a href="../../en/mathematics/method-solving-first-order-dde-using-lambert-w-function.html">A method to solve first-order time delay differential equation using Lambert W function</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">High Performance</span>
											<ul>
												<li><a href="../../en/high-performance/">INDEX</a></li>
												<li><a href="https://ettoremessina.tech/2024/09/14/high-performance-computing-of-discrete-single-variable-derivative-with-cuda/" target="_blank">High-Performance Computing of Discrete Single Variable Derivative with CUDA</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Datasets</span>
											<ul>
												<li><a href="../../en/datasets/">INDEX</a></li>
												<li><a href="../../en/datasets/functions-dataset.html">&apos;Functions&apos; dataset collection</a></li>
												<li><a href="../../en/datasets/time-series-dataset.html">&apos;Time&nbsp;Series&apos; dataset collection</a></li>
												<li><a href="../../en/datasets/synthetic-words-dataset.html">&apos;Synthetic Words&apos; dataset</a></li>
											</ul>
										</li>
										<li><a href="../../en/info.html">Info</a></li>
									</ul>
								</nav>

							<!-- Section -->
								<section>
                                    <div class="side-topics">
                                        <header class="align-center">
                                            <h2><a href="../../en/neural-networks/">Neural&nbsp;Networks</a></h2>
                                        </header>
                                        <article>
                                            <a href="../../en/neural-networks/" class="image"><span class="icon solid fa-sitemap"/></a>
                                        </article>
                                        <header class="align-center">
                                            <h2><a href="../../en/quantum-computing/">Quantum&nbsp;Computing</a></h2>
                                        </header>
                                        <article>
                                            <a href="../../en/quantum-computing/" class="image"><span class="icon solid fa-atom" /></a>
                                        </article>
                                    </div>
								</section>

							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">
										Design based on &apos;Editorial&apos; template (with customization) downloaded from <a href="https://html5up.net" target="_blank">HTML5 UP</a>.
										<br/>
										Click on links to see <a href="../../html5up-license/LICENSE.txt" target="_blank">LICENSE.txt</a> and <a href="../../html5up-license/README.txt" target="_blank">README.txt</a> files of &apos;Editorial&apos; template by HTML5 UP.
										<br>
										<br>
										&copy; <a href="../../en/info.html">Ettore Messina</a>. 
									</p>
								</footer>
						</div>
					</div>
			</div>

		<!-- Scripts -->
			<script src="../../assets/js/jquery.min.js"></script>
			<script src="../../assets/js/browser.min.js"></script>
			<script src="../../assets/js/breakpoints.min.js"></script>
			<script src="../../assets/js/util.js"></script>
			<script src="../../assets/js/main.js"></script>

			<style>
				a.cc-link
				{
				    border-bottom: none;
				}
				a.cc-link:hover
				{
					color: white !important;
				}
			</style>
	</body>
</html>

